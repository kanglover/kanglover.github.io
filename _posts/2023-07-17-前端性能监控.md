---
layout:     post
title:      性能
date:       2023-07-17
author:     shaokang
header-img:
catalog: true
tags:
    - 性能
    - FCP
---

## performance
指标：
* First Contentful Paint (FCP):  测量用户导航到您的页面后浏览器呈现第一段DOM内容所花费的时间。
* LCP(Largest Contentful Paint): 在视窗内可见的最大图像或文本块的渲染时间;
* TTI(Time to Interactive): 测量页面变为完全可交互所花费的时间。
* TBT(Total Blocking Time): 度量阻止页面响应用户输入（例如鼠标单击，屏幕敲击或键盘按压）的总时间。该指标是 First Contentful Paint 和 Time to Interactive 总和;
* CLS(Cumulative Layout Shift): 测量在页面的整个生命周期中发生的每个意外布局移位的得分的总和

Chrome Performance 工具分析
https://developer.chrome.com/docs/devtools/performance/

## 性能检测方案
### 监控系统分类
前端性能监控系统大致为分两类，Synthetic VS RUM（real-user monitoring）

* Synthetic  
依托于虚拟机，仿真的环境，有固定可控的外在条件，比如固定的网速。
* RUM  
业务项目中埋入统计代码，在海量用户的真实环境中进行监控，便于在性能超过预期时报警

### 相关工具
（一）Synthetic
#### [PageSpeed](https://pagespeed.web.dev/)
PageSpeed 能够针对移动设备和桌面设备生成网页的实际性能报告，并能够提供关于如何改进相应网页的建议。PageSpeed整合了LightHouse。PageSpeed Insights 还整合 Chrome 用户体验报告 (CrUX) 中的数据（为PageSpeed提供了方法论和统计维度），以显示网页的实际性能数据。PSI 会报告两项指标，即首次内容绘制 (FCP) 和文档内容加载 (DCL)。

PageSpeed Insights 会评估相应网页对常用的性能优化最佳做法的遵循情况，并计算出一个得分（分值介于 0 到 100 之间）来估算相应网页的性能优化空间。它评估的是相应网页是否可以从以下两个方面提升性能：
* 首屏加载时间：从用户请求打开新网页到浏览器呈现出首屏内容所用的时间。
* 完整网页加载时间：从用户请求打开新网页到浏览器完全呈现出相应网页所用的时间。

#### [LightHouse](https://developer.chrome.com/docs/lighthouse/overview/)
Lighthouse 是一个开源的自动化工具，用于改进网络应用的质量。 您可以将其作为一个 Chrome 扩展程序运行，或从命令行运行。 您为 Lighthouse 提供一个您要审查的网址，它将针对此页面运行一连串的测试，然后生成一个有关页面性能的报告。

提供 Chrome扩展程序插件和 npm 包命令行工具。

#### [WebPageTest](https://www.webpagetest.org/)
WebPageTest 是一款网页前端性能测试工具，工作原理是输入需统计的url并且选择运行次url的浏览器版本，webpageTest后台虚拟机对url进行请求分析后便可以给出各种性能指标，比如瀑布流、静态文件数量、首屏渲染时间等等。

使用方式
* 在线使用：https://www.webpagetest.org/
* 基于WebPageTest搭建性能监控平台：https://github.com/WPO-Foundation/webpagetest-docs/blob/master/user/Private%20Instances/README.md

#### [sitespeed.io](https://www.sitespeed.io/)
github： https://github.com/sitespeedio/sitespeed.io

简单可以拓展 Web 化自有的指标、支持多平台模拟，也可以在真机上进行测试，其提供的视频录制和视频指标采集等功能也能够清晰的体现用户的真实体验情况。可以搭建 docker 环境。

（二）RUM
项目中埋入统计代码。Google Analytic、百度统计

#### 工具对比
https://web.dev/speed-tools/


### 如何衡量一个站点的性能好坏
https://mp.weixin.qq.com/s/NBWEHTe-w0DbrtYl2HyXlw

### 资料
http://www.alloyteam.com/2020/01/14184/